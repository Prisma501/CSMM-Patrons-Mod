(function(e){function t(t){for(var r,i,s=t[0],c=t[1],l=t[2],p=0,m=[];p<s.length;p++)i=s[p],a[i]&&m.push(a[i][0]),a[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(m.length)m.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={app:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("85ec"),a=n.n(r);a.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d"),n("4989"),n("2dd8"),n("f9e3"),n("ab8b"),n("b15b");var r=n("ecee"),a=n("c074"),o=n("ad3d"),i=n("5f5b"),s=n("2b0e"),c=n("4776"),l=n.n(c),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("sidebar"),n("sdtd-map")],1)},p=[],m={name:"app"},d=m,h=(n("034f"),n("2877")),f=Object(h["a"])(d,u,p,!1,null,null,null),v=f.exports,g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{ref:"claimCreator",attrs:{id:"claim-creator",title:"Create a claim",size:"lg"},on:{ok:e.createClaim}},[null===e.selectedArea&&e.selectedRegions.length<1?n("div",[n("b-alert",{attrs:{variant:"warning",show:""}},[e._v("You must select an area on the map first!")])],1):e._e(),null!==e.selectedArea&&this.area<1?n("div",[n("b-alert",{attrs:{variant:"warning",show:""}},[e._v("You must select an area that is atleast 3x3 blocks big!")])],1):e._e(),null!==e.selectedArea&&this.area>1?n("div",[n("div",[n("div",[e._v(" You are creating a claim that is "),n("strong",[e._v(e._s(this.area))]),e._v(" blocks big. ")]),n("div",[e._v(" The current command is: "),n("div",[n("em",[e._v(e._s(e.command))])])]),n("hr"),n("label",{attrs:{for:"name"}},[e._v("Name")]),n("b-form-input",{attrs:{id:"name"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("label",{attrs:{for:"claim-accessLevel"}},[e._v("Accesslevel")]),n("b-form-input",{attrs:{type:"number",placeholder:"0"},model:{value:e.accessLevel,callback:function(t){e.accessLevel=t},expression:"accessLevel"}}),n("label",{attrs:{for:"type-select"}},[e._v("The type of claim. This will control its behaviour")]),n("b-form-select",{attrs:{id:"type-select",options:e.claimTypes},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}}),"leveled"===e.type?n("div",[n("p",[e._v(" This is a normal claim, but with the option to level the upper and lower boundary of a claim. A normal claim reaches from bedrock to heaven. This claim has height and depth. Designed for protecting underground bases (with a normal claim, players walking on ground above the base would get tp'd out without knowing what they intruded) or for bases that have public tunnels under them (with a normal claim, players wouldnt be able to use the tunnel under the protected base). ")]),n("label",{attrs:{for:"ycoordHigh"}},[e._v("Y coordinate top")]),n("b-form-input",{attrs:{id:"ycoordHigh",placeholder:"120",type:e.number},model:{value:e.options.yCoordHigh,callback:function(t){e.$set(e.options,"yCoordHigh",t)},expression:"options.yCoordHigh"}}),n("label",{attrs:{for:"ycoordLow"}},[e._v("Y coordinate bottom")]),n("b-form-input",{attrs:{id:"ycoordLow",placeholder:"40",type:e.number},model:{value:e.options.yCoordLow,callback:function(t){e.$set(e.options,"yCoordLow",t)},expression:"options.yCoordLow"}})],1):e._e(),"notify"===e.type?n("div",[n("p",[e._v(" This claim defines a zone in which players get a configurable message in chat when they enter or exit the claim. ")]),n("label",{attrs:{for:"enteringText"}},[e._v("Entering text")]),n("b-form-input",{attrs:{id:"enteringText",placeholder:"You are entering a claim",type:e.text,required:""},model:{value:e.options.enteringText,callback:function(t){e.$set(e.options,"enteringText",t)},expression:"options.enteringText"}}),n("label",{attrs:{for:"exitingText"}},[e._v("Exiting text")]),n("b-form-input",{attrs:{id:"exitingText",placeholder:"You are exiting a claim",type:e.text,required:""},model:{value:e.options.exitingText,callback:function(t){e.$set(e.options,"exitingText",t)},expression:"options.exitingText"}})],1):e._e(),"openhours"===e.type?n("div",[n("p",[e._v(" This is a normal claim, but with assigned opening hours. Tired of your lobby or central tradingstation getting abused/wrecked by players for surviving (horde) night? Just set it to opening hours 0400 to 2200 and players will get tp'd out if they enter the area outside that hours. ")]),n("label",{attrs:{for:"openingHour"}},[e._v("Opening hour")]),n("b-form-input",{attrs:{id:"openingHour",type:e.number},model:{value:e.options.openingHour,callback:function(t){e.$set(e.options,"openingHour",t)},expression:"options.openingHour"}}),n("label",{attrs:{for:"closingHour"}},[e._v("Closing hour")]),n("b-form-input",{attrs:{id:"closingHour",type:e.number},model:{value:e.options.closingHour,callback:function(t){e.$set(e.options,"closingHour",t)},expression:"options.closingHour"}})],1):e._e(),"portal"===e.type?n("div",[n("p",[e._v(" Define an area and a triggerheight and an allowed player will get tp'd to a preset location. ")]),n("label",{attrs:{for:"stepheight"}},[e._v("Stepheight")]),n("b-form-input",{attrs:{id:"stepheight",type:e.number},model:{value:e.options.stepheight,callback:function(t){e.$set(e.options,"stepheight",t)},expression:"options.stepheight"}}),n("h3",[e._v("Teleport destination")]),n("label",{attrs:{for:"portalX"}},[e._v("X coordinate")]),n("b-form-input",{attrs:{id:"portalX",type:e.number},model:{value:e.options.portalX,callback:function(t){e.$set(e.options,"portalX",t)},expression:"options.portalX"}}),n("label",{attrs:{for:"portalY"}},[e._v("Y coordinate")]),n("b-form-input",{attrs:{id:"portalY",type:e.number},model:{value:e.options.portalY,callback:function(t){e.$set(e.options,"portalY",t)},expression:"options.portalY"}}),n("label",{attrs:{for:"portalZ"}},[e._v("Z coordinate")]),n("b-form-input",{attrs:{id:"portalZ",type:e.number},model:{value:e.options.portalZ,callback:function(t){e.$set(e.options,"portalZ",t)},expression:"options.portalZ"}})],1):e._e(),"reversed"===e.type?n("div",[n("p",[e._v(" Create an area for locking players in (aka jail). When whitelisted for a reversed claim, a player cannot leave the area and will get tp'd back in if he/she tries. ")])]):e._e(),"hostilefree"===e.type?n("div",[n("p",[e._v(" This is used for creating hostilefree area's. All hostiles will despawn in this type of advanced claim.. ")])]):e._e(),"timed"===e.type?n("div",[n("p",[e._v(" Create an area for protecting bases/structures. Players not on whitelist of the claim will get tp'd out. This claim type has a time to live (hours). After the time has passed this claim will vanish. ")]),n("label",{attrs:{for:"timeToLive"}},[e._v("Hours before claims vanishes")]),n("b-form-input",{attrs:{id:"timeToLive",type:e.number},model:{value:e.options.timeToLive,callback:function(t){e.$set(e.options,"timeToLive",t)},expression:"options.timeToLive"}})],1):e._e(),"command"===e.type?n("div",[n("p",[e._v(" Trigger one or multiple console commands when a player enter this claim area. The claim type must be enclosed in double quotes and parameters with spaces within each command must be enclosed in single quotes. Use semicolon ( ; ) to seperate commands. ")]),n("label",{attrs:{for:"command"}},[e._v("Command to execute")]),n("b-form-input",{attrs:{id:"command"},model:{value:e.options.command,callback:function(t){e.$set(e.options,"command",t)},expression:"options.command"}})],1):e._e(),"playerlevel"===e.type?n("div",[n("p",[e._v(" This claim can be used to restrict/grant access to a claim by player level. Built in basic logical expression, plus support for level ranges. ")]),n("label",{attrs:{for:"playerLevelCheck"}},[e._v("Operator check")]),n("b-form-input",{attrs:{id:"playerLevelCheck"},model:{value:e.options.playerLevelCheck,callback:function(t){e.$set(e.options,"playerLevelCheck",t)},expression:"options.playerLevelCheck"}})],1):e._e(),"lcbfree"===e.type?n("div",[n("p",[e._v(" Control abillity to place LCB's within the boundaries of the lcbfree adv. claim. Allow to place LCB's by accesslevel and/or whitelist. If not allowed to place LCB, it will be removed and put back in player inventory. ")])]):e._e(),"antiblock"===e.type?n("div",[n("p",[e._v(" Use this claim to prevent placement of configurable block(s). Blocks that are not allowed in this claim will be instantly(!) removed. Configured blocks must have the "),n("strong",[e._v("exact")]),e._v(" name as they have ingame and be separated by ; ")]),n("label",{attrs:{for:"antiBlockBLocks"}},[e._v("Forbidden blocks")]),n("b-form-input",{attrs:{id:"antiBlockBLocks"},model:{value:e.options.antiBlockBlocks,callback:function(t){e.$set(e.options,"antiBlockBlocks",t)},expression:"options.antiBlockBlocks"}})],1):e._e(),"landclaim"===e.type?n("div",[n("p",[e._v(' only claimowners, whitelisted players and accesslevel allowed players can place any block within this adv. claim. Type= "landclaim". Violation string configurable in CpmStrings.xml (AdvClaims_Landclaim). Auto giveback to placing player. ')])]):e._e(),"problock"===e.type?n("div",[n("p",[e._v(" Use this claim to prevent placement of blocks that are not configured as problock(s). Violation string configurable in CpmStrings.xml (AdvClaims_ProBlock). Auto giveback to placing player. ")]),n("label",{attrs:{for:"problockBlocks"}},[e._v("Allowed blocks")]),n("b-form-input",{attrs:{id:"problockBlocks"},model:{value:e.options.problockBlocks,callback:function(t){e.$set(e.options,"problockBlocks",t)},expression:"options.problockBlocks"}})],1):e._e()],1)]):e._e(),e.selectedRegions.length>0?n("div",[n("div",[e._v("You have selected "+e._s(e.selectedRegions.length)+" regions.")]),n("ul",{attrs:{id:"reset-regions"}},e._l(e.selectedRegions,(function(t,r){return n("li",{key:"region-"+r},[e._v(" "+e._s(t)+" ")])})),0)]):e._e()])},b=[],y=(n("ac4d"),n("8a81"),n("ac6a"),n("7f7f"),n("28a5"),{data:function(){return{claimTypes:window.claimTypes,name:"My_cool_new_claim",type:null,options:{yCoordHigh:120,yCoordLow:40,enteringText:"You are entering a claim",exitingText:"You are exiting a claim",openingHour:"9",closingHour:"17",stepheight:64,portalX:50,portalY:0,portalZ:-80,timeToLive:12,command:"say 'Welcome ${playerName} to the claim!'",playerLevelCheck:"<=20",antiBlockBlocks:"forbidden1;forbidden2",problockBlocks:"allowed1;allowed2"},accessLevel:0}},props:["selectedArea","selectedRegions"],computed:{area:function(){var e=Math.abs(this.selectedArea[0].lat-this.selectedArea[1].lat),t=Math.abs(this.selectedArea[0].lng-this.selectedArea[1].lng);return Math.round(2*(e+t))},command:function(){var e="ccc add ".concat(this.name.split(" ").join("_")," ").concat(this.getW()," ").concat(this.getE()," ").concat(this.getN()," ").concat(this.getS()," ").concat(this.accessLevel," ");switch(this.type){case"normal":break;case"hostilefree":e+="".concat(this.type);break;case"leveled":e+='"'.concat(this.type,":").concat(this.options.yCoordHigh,",").concat(this.options.yCoordLow,'"');break;case"notify":e+='"'.concat(this.type,":").concat(this.options.enteringText,":").concat(this.options.exitingText,'"');break;case"openhours":e+='"'.concat(this.type,":").concat(this.options.openingHour,"-").concat(this.options.closingHour,'"');break;case"portal":e+='"'.concat(this.type,":").concat(Math.round(this.options.stepheight),":").concat(Math.round(this.options.portalX),",").concat(Math.round(this.options.portalY),",").concat(Math.round(this.options.portalZ),'"');break;case"reversed":e+="".concat(this.type);break;case"timed":e+="".concat(this.type,":").concat(this.options.timeToLive);break;case"command":e+='"'.concat(this.type,":").concat(this.options.command,'"');break;case"lcbfree":e+="".concat(this.type);break;case"playerlevel":e+='"'.concat(this.type,":").concat(this.options.playerLevelCheck,'"');break;case"antiblock":e+="".concat(this.type,":").concat(this.options.antiBlockBlocks);break;case"reset":e+="".concat(this.type);break;case"landclaim":e+="".concat(this.type);break;case"problock":e+="".concat(this.type,":").concat(this.options.problockBlocks);break;default:break}return e}},methods:{createClaim:function(){if(this.selectedArea&&pe.$emit("add-command",this.command),this.selectedRegions.length){var e=!0,t=!1,n=void 0;try{for(var r,a=this.selectedRegions[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=r.value;pe.$emit("add-command","mrr add ".concat(o))}}catch(i){t=!0,n=i}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},getW:function(){return Math.round(Math.min(this.selectedArea[0].lat,this.selectedArea[1].lat))},getE:function(){return Math.round(Math.max(this.selectedArea[0].lat,this.selectedArea[1].lat))},getN:function(){return Math.round(Math.max(this.selectedArea[0].lng,this.selectedArea[1].lng))},getS:function(){return Math.round(Math.min(this.selectedArea[0].lng,this.selectedArea[1].lng))}}}),x=y,k=Object(h["a"])(x,g,b,!1,null,null,null),w=k.exports,_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{ref:"claimsModal",attrs:{id:"claims",title:"Claims",size:"xl"}},[n("b-button-group",[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"claim-creator",expression:"'claim-creator'"}],attrs:{variant:"success"}},[e._v("Create")]),n("b-button",{attrs:{variant:"danger"},on:{click:e.onDelete}},[e._v("Delete claim(s)")])],1),n("b-table",{attrs:{striped:"",hover:"",items:e.claims,borderless:e.borderless,small:e.small,selectable:"","select-mode":e.multi},on:{"row-selected":e.rowSelected}})],1),n("claim-creator",{attrs:{selectedArea:e.selectedArea,selectedRegions:e.selectedRegions}})],1)},C=[],T=(n("96cf"),n("3b8d")),S=n("e11e"),z=n.n(S);n("f559");function L(e){return R.apply(this,arguments)}function R(){return R=Object(T["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("resetregion"!==t){e.next=2;break}return e.abrupt("return",fetch("/api/getresetregions").then((function(e){return e?e.json():[]})).then((function(e){return e})));case 2:return e.abrupt("return",fetch("/api/getadvclaims?type=".concat(t)).then((function(e){return e?e.json():[]})).then((function(e){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var c=i.value;M(c,t)&&n.push(c)}}catch(l){a=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n})));case 3:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}function M(e,t){return!!e.Type.startsWith(t)||"normal"===t&&""===e.Type}var P={data:function(){return{mapInfo:{regionsize:512,chunksize:16,tilesize:128,maxzoom:4},selected:[],claims:[],commands:[],selectedArea:null,selectedRegions:[],claimTypes:window.claimTypes,connectionInfo:{ip:"",port:"",adminUser:"",adminToken:""}}},computed:{cpmPort:function(){return parseInt(this.connectionInfo.port)+1}},mounted:function(){var e=this;localStorage.connectionInfo&&(this.connectionInfo=JSON.parse(localStorage.connectionInfo)),this.drawClaims(),pe.$on("refresh-claims",(function(){e.claims=[],e.drawClaims()})),pe.$on("area-selected",(function(t){e.selectedArea=t})),pe.$on("region-selected",(function(t){e.selectedRegions=t})),pe.$on("add-command",(function(t){e.commands.push(t)}))},methods:{FormatRegionFileName:function(e){return"r."+e.lat+"."+e.lng+".7rg"},CoordToRegion:function(e){var t=Math.floor((e.lat+16777216)/this.mapInfo.regionsize-16777216/this.mapInfo.regionsize),n=Math.floor((e.lng+16777216)/this.mapInfo.regionsize-16777216/this.mapInfo.regionsize);return z.a.latLng(t,n)},onDelete:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t=!0,n=!1,r=void 0,e.prev=3,a=this.selected[Symbol.iterator]();!(t=(o=a.next()).done);t=!0)i=o.value,"Reset region"===i["Claim type"]?pe.$emit("add-command","mrr remove ".concat(i.Name)):pe.$emit("add-command","ccc remove ".concat(i.Name));e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](3),n=!0,r=e.t0;case 11:e.prev=11,e.prev=12,t||null==a.return||a.return();case 14:if(e.prev=14,!n){e.next=17;break}throw r;case 17:return e.finish(14);case 18:return e.finish(11);case 19:case"end":return e.stop()}}),e,this,[[3,7,11,19],[12,,14,18]])})));function t(){return e.apply(this,arguments)}return t}(),rowSelected:function(e){this.selected=e},drawClaims:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i,s,c,l,u,p,m,d,h,f,v,g,b,y,x,k;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,L("resetregion");case 2:t=e.sent,n=!0,r=!1,a=void 0,e.prev=6,o=this.claimTypes[Symbol.iterator]();case 8:if(n=(i=o.next()).done){e.next=35;break}return s=i.value,e.next=12,L(s);case 12:for(c=e.sent,l=!0,u=!1,p=void 0,e.prev=16,m=c[Symbol.iterator]();!(l=(d=m.next()).done);l=!0)h=d.value,h["Claim type"]=s,h.options=h.Type,delete h.Type,this.claims.push(h);e.next=24;break;case 20:e.prev=20,e.t0=e["catch"](16),u=!0,p=e.t0;case 24:e.prev=24,e.prev=25,l||null==m.return||m.return();case 27:if(e.prev=27,!u){e.next=30;break}throw p;case 30:return e.finish(27);case 31:return e.finish(24);case 32:n=!0,e.next=8;break;case 35:e.next=41;break;case 37:e.prev=37,e.t1=e["catch"](6),r=!0,a=e.t1;case 41:e.prev=41,e.prev=42,n||null==o.return||o.return();case 44:if(e.prev=44,!r){e.next=47;break}throw a;case 47:return e.finish(44);case 48:return e.finish(41);case 49:for(f=!0,v=!1,g=void 0,e.prev=52,b=t[Symbol.iterator]();!(f=(y=b.next()).done);f=!0)x=y.value,k=this.CoordToRegion({lat:(x.W+x.E)/2,lng:(x.N+x.S)/2}),x.Name=this.FormatRegionFileName(k),x["Claim type"]="Reset region",this.claims.push(x);e.next=60;break;case 56:e.prev=56,e.t2=e["catch"](52),v=!0,g=e.t2;case 60:e.prev=60,e.prev=61,f||null==b.return||b.return();case 63:if(e.prev=63,!v){e.next=66;break}throw g;case 66:return e.finish(63);case 67:return e.finish(60);case 68:case"end":return e.stop()}}),e,this,[[6,37,41,49],[16,20,24,32],[25,,27,31],[42,,44,48],[52,56,60,68],[61,,63,67]])})));function t(){return e.apply(this,arguments)}return t}(),getClaims:function(e){return"resetregion"===e?fetch("/api/getresetregions").then((function(e){return e?e.json():[]})).then((function(e){return e})):fetch("/api/getadvclaims?type=".concat(e)).then((function(e){return e?e.json():[]})).then((function(e){return e}))}}},I=P,O=Object(h["a"])(I,_,C,!1,null,"1834141e",null),j=O.exports,A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{id:"commands",title:"Commands",size:"lg"}},[e.executing?n("div",[n("b-progress",{attrs:{value:e.executed,max:e.commands.length,"show-progress":"",animated:""}})],1):e._e(),e.commands.length>0?n("div",[n("b-button",{staticClass:"mx-auto",attrs:{variant:"success",size:"lg"},on:{click:e.execute}},[e._v("Execute "+e._s(e.commands.length)+" command"+e._s(e.commands.length>1?"s":""))]),n("ul",e._l(e.commands,(function(t,r){return n("li",{key:"command-"+r},[n("b-button",{attrs:{variant:"danger"},on:{click:function(t){return e.deleteCommand(r)}}},[n("font-awesome-icon",{attrs:{icon:"trash-alt",size:"xs"}}),e._v("Delete ")],1),e._v(" "+e._s(t)+" ")],1)})),0),n("hr")],1):n("div",[n("p",[e._v("There are no commands in the queue yet. Create or delete some claims first!")])]),n("hr"),n("h3",[e._v("History")]),n("div",[n("ul",e._l(e.history,(function(t,r){return n("span",{key:"history-"+r,class:{"text-danger":!t.success,"text-success":t.success}},[n("li",{attrs:{id:e.generateId(t)}},[e._v(e._s(e.formatDate(t.date))+" - "+e._s(t.command))]),n("b-tooltip",{attrs:{target:e.generateId(t),placement:"left"}},[e._v(e._s(t.statusText))])],1)})),0)])])],1)},$=[],H=(n("5df3"),n("4f7f"),n("75fc")),N=(n("a481"),{data:function(){return{commands:[],connectionInfo:{ip:"",port:"",adminUser:"",adminToken:""},history:[],executing:!1,executed:0}},methods:{generateId:function(e){return"".concat(e.date,"-").concat(e.command.replace("","-"))},formatDate:function(e){var t=new Date(e);return t.toLocaleString()},getHistory:function(){var e=localStorage.commandHistory;return e=e?JSON.parse(e):[],this.history=e,e},setHistory:function(e){this.history=e,localStorage.setItem("commandHistory",JSON.stringify(this.history))},addToHistory:function(e){var t=this.getHistory();t.unshift(e),this.setHistory(t)},deleteCommand:function(e){this.commands.splice(e,1),pe.$emit("set-commands",this.commands.length)},execute:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.executing=!0,t=!0,n=!1,r=void 0,e.prev=4,a=regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=i.value,e.next=3,fetch("/api/createadvclaims?command=".concat(t));case 3:n=e.sent,r={success:n.ok,command:t,statusText:n.statusText,date:Date.now()},s.commands=s.commands.filter((function(e){return e!==t})),s.addToHistory(r),s.executed++;case 8:case"end":return e.stop()}}),e)})),o=this.commands[Symbol.iterator]();case 7:if(t=(i=o.next()).done){e.next=12;break}return e.delegateYield(a(),"t0",9);case 9:t=!0,e.next=7;break;case 12:e.next=18;break;case 14:e.prev=14,e.t1=e["catch"](4),n=!0,r=e.t1;case 18:e.prev=18,e.prev=19,t||null==o.return||o.return();case 21:if(e.prev=21,!n){e.next=24;break}throw r;case 24:return e.finish(21);case 25:return e.finish(18);case 26:pe.$emit("set-commands",this.commands.length),pe.$emit("refresh-claims"),this.executing=!1,this.executed=0;case 30:case"end":return e.stop()}}),e,this,[[4,14,18,26],[19,,21,25]])})));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){var e=this;localStorage.connectionInfo&&(this.connectionInfo=JSON.parse(localStorage.connectionInfo)),this.getHistory(),pe.$on("connection-info",(function(t){e.connectionInfo=t})),pe.$on("add-command",(function(t){e.commands.push(t),e.commands=Object(H["a"])(new Set(e.commands)),e.$bvToast.toast(t,{title:"A command was added to the queue"}),pe.$emit("set-commands",e.commands.length)}))}}),E=N,U=(n("b167"),Object(h["a"])(E,A,$,!1,null,"f2ded366",null)),B=U.exports,Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"map-container"}},[n("div",{attrs:{id:"map"}},[n("center",[e._v(e._s(e.mapMessage))]),n("div",{staticClass:"leaflet-bottom leaflet-right"},[n("b-button-group",{attrs:{size:"sm",id:"selection-control",vertical:""}},[n("b-button",{attrs:{disabled:"area"===e.selectionMode},on:{click:e.areaSelect}},[e._v("Select area")]),n("b-button",{attrs:{disabled:"region"===e.selectionMode},on:{click:e.regionSelect}},[e._v("Select region")]),n("b-button",{attrs:{variant:"danger"},on:{click:e.clearSelection}},[e._v("Clear selection")])],1)],1)],1)])},D=[],W=(n("7514"),n("5118")),Z=z.a.icon({iconUrl:"img/marker-survivor.png",iconRetinaUrl:"img/marker-survivor-2x.png",iconSize:[25,48],iconAnchor:[12,24],popupAnchor:[0,-20]}),F=z.a.icon({iconUrl:"img/home-icon.png",iconSize:[25,25],iconAnchor:[12,24],popupAnchor:[0,-20]}),V=z.a.icon({iconUrl:"img/vehicle-icon.png",iconSize:[50,50],iconAnchor:[12,24],popupAnchor:[0,-20]}),q=z.a.icon({iconUrl:"img/shopping-cart.png",iconSize:[25,25],iconAnchor:[12,24],popupAnchor:[0,-20]}),G={name:"sdtd-map",data:function(){return{map:null,tileLayer:null,layers:[],mapMessage:"Please fill in connection info in the server settings tab.",mapInfo:{regionsize:512,chunksize:16,tilesize:128,maxzoom:4},userStatus:{loggedin:!1,username:null,permissionlevel:2e3,permissions:[]},clickMarkers:[],selectedRegionsRecs:[],selectedRegions:[],selectedArea:null,claimTypes:window.claimTypes,connectionInfo:{ip:"",port:"",adminUser:"",adminToken:""},selectionMode:"area",colors:["purple","cyan","red","green","blue","yellow","orange","brown","coral","chocolate","skyblue","#fc079e","#bdd3cb","#bada55","#008000","#ffc0cb"],colorIterator:0}},computed:{cpmPort:function(){return parseInt(this.connectionInfo.port)+1},activeColor:function(){return this.colors[this.colorIterator]}},mounted:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.userStatus=this.getUserStatus(),this.userStatus.then((function(e){t.userStatus=e,Object(W["setInterval"])((function(){t.drawLandClaims(),t.drawPlayers(),t.drawHomes(),t.drawQuestPoi(),t.drawTraders(),t.drawPois()}),3e4),t.createMap(),pe.$on("refresh-claims",(function(){null!=t.map&&(t.map.remove(),t.map=null,t.createMap())}))}));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{hasPermission:function(e){var t=this.userStatus.permissions.find((function(t){return t.module.toUpperCase()===e.toUpperCase()}));return void 0!==t&&t.allowed},getUserStatus:function(){return fetch("/userstatus").then((function(e){return e.json()})).then((function(e){return e}))},getLandClaims:function(){return fetch("/api/getlandclaims").then((function(e){return e.json()})).then((function(e){return e}))},drawLandClaims:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i,s,c,l,u,p,m,d,h,f,v;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.hasPermission("cpmcc.getlandclaims")){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getLandClaims();case 4:t=e.sent,n=(t.claimsize-1)/2,r=this.layers["Land claim blocks"],r||(this.layers["Land claim blocks"]=new z.a.LayerGroup,r=this.layers["Land claim blocks"]),r.clearLayers(),a=!0,o=!1,i=void 0,e.prev=12,s=t.claimowners[Symbol.iterator]();case 14:if(a=(c=s.next()).done){e.next=38;break}for(l=c.value,u=!0,p=!1,m=void 0,e.prev=19,d=l.claims[Symbol.iterator]();!(u=(h=d.next()).done);u=!0)f=h.value,v=z.a.rectangle([[f.x-n,f.z-n],[f.x+n,f.z+n]]).bindPopup("".concat(l.playername," - ").concat(l.steamid," <br> Status: ").concat(l.claimactive?"Active":"Inactive")),r.addLayer(v);e.next=27;break;case 23:e.prev=23,e.t0=e["catch"](19),p=!0,m=e.t0;case 27:e.prev=27,e.prev=28,u||null==d.return||d.return();case 30:if(e.prev=30,!p){e.next=33;break}throw m;case 33:return e.finish(30);case 34:return e.finish(27);case 35:a=!0,e.next=14;break;case 38:e.next=44;break;case 40:e.prev=40,e.t1=e["catch"](12),o=!0,i=e.t1;case 44:e.prev=44,e.prev=45,a||null==s.return||s.return();case 47:if(e.prev=47,!o){e.next=50;break}throw i;case 50:return e.finish(47);case 51:return e.finish(44);case 52:return e.abrupt("return",r);case 53:case"end":return e.stop()}}),e,this,[[12,40,44,52],[19,23,27,35],[28,,30,34],[45,,47,51]])})));function t(){return e.apply(this,arguments)}return t}(),getPois:function(){return fetch("/api/getallpois").then((function(e){return e.json()})).then((function(e){return e}))},drawPois:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i,s,c,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.hasPermission("cpmcc.getallpois")){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getPois();case 4:for(t=e.sent,n=t.AllPOIs,r=this.layers["POIs"],r||(this.layers["POIs"]=new z.a.LayerGroup,r=this.layers["POIs"]),a=!0,o=!1,i=void 0,e.prev=11,s=n[Symbol.iterator]();!(a=(c=s.next()).done);a=!0)l=c.value,u=this.createClaimRectangle({W:l.minx,E:l.maxx,S:l.minz,N:l.maxz},void 0,"orange"),u.bindPopup("".concat(l.name," - ").concat(l.containsbed?"Contains bed":"Unclaimed")),r.addLayer(u);e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](11),o=!0,i=e.t0;case 19:e.prev=19,e.prev=20,a||null==s.return||s.return();case 22:if(e.prev=22,!o){e.next=25;break}throw i;case 25:return e.finish(22);case 26:return e.finish(19);case 27:case"end":return e.stop()}}),e,this,[[11,15,19,27],[20,,22,26]])})));function t(){return e.apply(this,arguments)}return t}(),getTraders:function(){return fetch("/api/gettraders").then((function(e){return e.json()})).then((function(e){return e}))},drawTraders:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i,s,c,l,u,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.hasPermission("cpmcc.gettraders")){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getTraders();case 4:for(t=e.sent,n=t.Traders,r=this.layers["Traders"],r||(this.layers["Traders"]=new z.a.LayerGroup,r=this.layers["Traders"]),r.clearLayers(),a=!0,o=!1,i=void 0,e.prev=12,s=n[Symbol.iterator]();!(a=(c=s.next()).done);a=!0)l=c.value,u=this.createClaimRectangle({W:l.minx,E:l.maxx,S:l.minz,N:l.maxz},void 0,"green"),p=z.a.marker([l.x,l.z],{icon:q}).bindPopup(l.name),r.addLayer(p),r.addLayer(u);e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](12),o=!0,i=e.t0;case 20:e.prev=20,e.prev=21,a||null==s.return||s.return();case 23:if(e.prev=23,!o){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}}),e,this,[[12,16,20,28],[21,,23,27]])})));function t(){return e.apply(this,arguments)}return t}(),getPlayers:function(){return fetch("/api/getplayersonline").then((function(e){return e.json()})).then((function(e){return e}))},drawPlayers:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i,s,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.hasPermission("cpmcc.getplayersonline")){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getPlayers();case 4:for(t=e.sent,n=this.layers["Online players"],n||(this.layers["Online players"]=new z.a.LayerGroup,n=this.layers["Online players"]),n.clearLayers(),r=!0,a=!1,o=void 0,e.prev=11,i=t[Symbol.iterator]();!(r=(s=i.next()).done);r=!0)c=s.value,l=z.a.marker([c.position.x,c.position.z],{icon:Z}).bindPopup("".concat(c.name," - ").concat(c.steamid," <br> Position: ").concat(c.position.x," ").concat(c.position.y," ").concat(c.position.z)),n.addLayer(l);e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](11),a=!0,o=e.t0;case 19:e.prev=19,e.prev=20,r||null==i.return||i.return();case 22:if(e.prev=22,!a){e.next=25;break}throw o;case 25:return e.finish(22);case 26:return e.finish(19);case 27:return e.abrupt("return",n);case 28:case"end":return e.stop()}}),e,this,[[11,15,19,27],[20,,22,26]])})));function t(){return e.apply(this,arguments)}return t}(),getQuestPoi:function(e){var t="/api/getquestpois".concat(e?"?filter=bedlcbonly":"");return fetch(t).then((function(e){return e.json()})).then((function(e){return e}))},drawQuestPoi:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i,s,c,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.hasPermission("cpmcc.getquestpois")){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getQuestPoi();case 4:for(t=e.sent,n=this.layers["Quest POIs"],n||(this.layers["Quest POIs"]=new z.a.LayerGroup,n=this.layers["Quest POIs"]),r=this.layers["Claimed quest POIs"],r||(this.layers["Claimed quest POIs"]=new z.a.LayerGroup,r=this.layers["Claimed quest POIs"]),a=!0,o=!1,i=void 0,e.prev=12,s=t.QuestPOIs[Symbol.iterator]();!(a=(c=s.next()).done);a=!0)l=c.value,u=this.createClaimRectangle({W:l.minx,E:l.maxx,S:l.minz,N:l.maxz},void 0,l.containsbed?"red":"blue").bindPopup(l.name),n.addLayer(u),l.containsbed&&r.addLayer(u);e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](12),o=!0,i=e.t0;case 20:e.prev=20,e.prev=21,a||null==s.return||s.return();case 23:if(e.prev=23,!o){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}}),e,this,[[12,16,20,28],[21,,23,27]])})));function t(){return e.apply(this,arguments)}return t}(),getVehicles:function(){return fetch("/api/getvehicles").then((function(e){return e.json()})).then((function(e){return e}))},drawVehicles:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i,s,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.hasPermission("cpmcc.GetVehicles")){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getVehicles();case 4:for(t=e.sent,n=this.layers["Vehicles"],n||(this.layers["Vehicles"]=new z.a.LayerGroup,n=this.layers["Vehicles"]),n.clearLayers(),r=!0,a=!1,o=void 0,e.prev=11,i=t.Vehicles[Symbol.iterator]();!(r=(s=i.next()).done);r=!0)c=s.value,l=z.a.marker([c.posX,c.posZ],{icon:V}).bindPopup("Vehicle: ".concat(c.name," <br> Position: ").concat(c.posX," ").concat(c.posY,"  ").concat(c.posZ)),n.addLayer(l);e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](11),a=!0,o=e.t0;case 19:e.prev=19,e.prev=20,r||null==i.return||i.return();case 22:if(e.prev=22,!a){e.next=25;break}throw o;case 25:return e.finish(22);case 26:return e.finish(19);case 27:case"end":return e.stop()}}),e,this,[[11,15,19,27],[20,,22,26]])})));function t(){return e.apply(this,arguments)}return t}(),getHomes:function(){return fetch("/api/getplayerhomes").then((function(e){return e.json()})).then((function(e){return e}))},drawHomes:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i,s,c,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.hasPermission("cpmcc.getplayerhomes")){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getHomes();case 4:for(t=e.sent,n=this.layers["Homes"],n||(this.layers["Homes"]=new z.a.LayerGroup,n=this.layers["Homes"]),n.clearLayers(),r=!0,a=!1,o=void 0,e.prev=11,i=t.homeowners[Symbol.iterator]();!(r=(s=i.next()).done);r=!0)c=s.value,l=this.createClaimRectangle({W:c.x-t.homesize,E:c.x+t.homesize,S:c.z-t.homesize,N:c.z+t.homesize},void 0,c.active?"green":"red"),u=z.a.marker([c.x,c.z],{icon:F}).bindPopup("Home owner: ".concat(c.steamid," <br> Position: ").concat(c.x," ").concat(c.y," ").concat(c.z)),n.addLayer(l),n.addLayer(u);e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](11),a=!0,o=e.t0;case 19:e.prev=19,e.prev=20,r||null==i.return||i.return();case 22:if(e.prev=22,!a){e.next=25;break}throw o;case 25:return e.finish(22);case 26:return e.finish(19);case 27:case"end":return e.stop()}}),e,this,[[11,15,19,27],[20,,22,26]])})));function t(){return e.apply(this,arguments)}return t}(),areaSelect:function(e){z.a.DomEvent.stop(e),this.clearSelection(),this.selectionMode="area"},regionSelect:function(e){z.a.DomEvent.stop(e),this.clearSelection(),this.selectionMode="region"},clearSelection:function(e){e&&z.a.DomEvent.stop(e);var t=!0,n=!1,r=void 0;try{for(var a,o=this.clickMarkers[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var i=a.value;i.remove()}}catch(d){n=!0,r=d}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}this.clickMarkers=[],this.selectedArea&&this.selectedArea.remove();var s=!0,c=!1,l=void 0;try{for(var u,p=this.selectedRegionsRecs[Symbol.iterator]();!(s=(u=p.next()).done);s=!0){var m=u.value;m.remove()}}catch(d){c=!0,l=d}finally{try{s||null==p.return||p.return()}finally{if(c)throw l}}this.selectedRegions=[],pe.$emit("area-selected",null),pe.$emit("region-selected",this.selectedRegions)},handleRegionClick:function(){},handleAreaClick:function(){},createMap:function(){var e=this;this.mapMessage="",this.initMap(),this.initLayers(),this.createCoordinateControl(),this.map.on("click",(function(t){if("area"===e.selectionMode&&(e.clickMarkers.length>1&&(e.clickMarkers[0].remove(),e.clickMarkers=e.clickMarkers.slice(1,e.clickMarkers.length)),e.clickMarkers.push(z.a.circle(t.latlng,{radius:1}).addTo(e.map)),2===e.clickMarkers.length)){var n=[e.clickMarkers[0].getLatLng(),e.clickMarkers[1].getLatLng()];e.selectedArea&&e.selectedArea.remove();var r=z.a.rectangle(n,{weight:1}).addTo(e.map);e.selectedArea=r,pe.$emit("area-selected",n)}if("region"===e.selectionMode){var a=e.CoordToRegion(t.latlng),o=e.FormatRegionFileName(a),i={W:a.lat*e.mapInfo.regionsize,E:a.lat*e.mapInfo.regionsize+e.mapInfo.regionsize,N:a.lng*e.mapInfo.regionsize+e.mapInfo.regionsize,S:a.lng*e.mapInfo.regionsize,Name:o,Type:"To be confirmed reset region"},s=e.createClaimRectangle(i,"Selected region","grey");s.addTo(e.map),e.selectedRegionsRecs.push(s),e.selectedRegions.push(o),pe.$emit("region-selected",e.selectedRegions)}}))},GetSdtdTileLayer:function(e){var t=z.a.tileLayer("/map/{z}/{x}/{y}.png",{maxZoom:e.maxzoom+1,minZoom:Math.max(0,e.maxzoom-5),maxNativeZoom:e.maxzoom,minNativeZoom:0,tileSize:e.tilesize});return t.getTileUrl=function(e){return e.y=-e.y-1,z.a.TileLayer.prototype.getTileUrl.bind(t)(e)},t},initMap:function(){var e=this.mapInfo,t={project:function(t){return new z.a.Point(t.lat/Math.pow(2,e.maxzoom),t.lng/Math.pow(2,e.maxzoom))},unproject:function(t){return new z.a.LatLng(t.x*Math.pow(2,e.maxzoom),t.y*Math.pow(2,e.maxzoom))}},n=z.a.extend({},z.a.CRS.Simple,{projection:t,transformation:new z.a.Transformation(1,0,-1,0),scale:function(e){return Math.pow(2,e)}});this.map=z.a.map("map",{attributionControl:!1,crs:n,zoomControl:!1}).setView([0,0],Math.max(0,this.mapInfo.maxzoom-1)),z.a.control.zoom({position:"topright"}).addTo(this.map)},drawAllClaims:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.colorIterator=0,t=!0,n=!1,r=void 0,e.prev=4,a=this.claimTypes[Symbol.iterator]();case 6:if(t=(o=a.next()).done){e.next=14;break}return i=o.value,e.next=10,this.drawClaim(i);case 10:this.colorIterator++;case 11:t=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](4),n=!0,r=e.t0;case 20:e.prev=20,e.prev=21,t||null==a.return||a.return();case 23:if(e.prev=23,!n){e.next=26;break}throw r;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return this.colorIterator=0,e.next=31,this.drawClaim("resetregion");case 31:case"end":return e.stop()}}),e,this,[[4,16,20,28],[21,,23,27]])})));function t(){return e.apply(this,arguments)}return t}(),drawClaim:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(t){var n,r,a,o,i,s,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("resetregion"!==t){e.next=5;break}if(this.hasPermission("cpmcc.getresetregions")){e.next=3;break}return e.abrupt("return");case 3:e.next=7;break;case 5:if(this.hasPermission("cpmcc.getadvclaims")){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,L(t);case 9:for(n=e.sent,r=[],a=!0,o=!1,i=void 0,e.prev=14,s=n[Symbol.iterator]();!(a=(c=s.next()).done);a=!0)l=c.value,r.push(this.createClaimRectangle(l,t));e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](14),o=!0,i=e.t0;case 22:e.prev=22,e.prev=23,a||null==s.return||s.return();case 25:if(e.prev=25,!o){e.next=28;break}throw i;case 28:return e.finish(25);case 29:return e.finish(22);case 30:this.layers[t]=new z.a.LayerGroup(r),this.layers[t].addTo(this.map);case 32:case"end":return e.stop()}}),e,this,[[14,18,22,30],[23,,25,29]])})));function t(t){return e.apply(this,arguments)}return t}(),createClaimRectangle:function(e,t,n){var r,a=z.a.rectangle([[e.W,e.S],[e.E,e.N]],{color:n||this.activeColor,weight:1});t&&(r="resetregion"===t?z.a.popup().setContent("Reset region"):z.a.popup().setContent("Name: ".concat(e.Name," Type: ").concat(t," ").concat(e.Type)),a.bindPopup(r));return a},initLayers:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.tileLayer=this.GetSdtdTileLayer(this.mapInfo),this.tileLayer.addTo(this.map),e.next=4,this.drawAllClaims();case 4:return e.next=6,this.drawLandClaims();case 6:return e.next=8,this.drawPlayers();case 8:return e.next=10,this.drawHomes();case 10:return e.next=12,this.drawVehicles();case 12:return e.next=14,this.drawQuestPoi();case 14:return e.next=16,this.drawTraders();case 16:return e.next=18,this.drawPois();case 18:this.layers["Regions"]=this.getRegionLayer(this.mapInfo),z.a.control.layers(null,this.layers).addTo(this.map);case 20:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),FormatRegionFileName:function(e){return"r."+e.lat+"."+e.lng+".7rg"},CoordToRegion:function(e){var t=Math.floor((e.lat+16777216)/this.mapInfo.regionsize-16777216/this.mapInfo.regionsize),n=Math.floor((e.lng+16777216)/this.mapInfo.regionsize-16777216/this.mapInfo.regionsize);return z.a.latLng(t,n)},getRegionLayer:function(e){var t=this,n=z.a.gridLayer({maxZoom:e.maxzoom+1,minZoom:0,maxNativeZoom:e.maxzoom+1,tileSize:e.tilesize});return n.createTile=function(n){var r=e.tilesize*Math.pow(2,e.maxzoom-n.z),a=n.x*r,o=(-1-n.y)*r,i=z.a.latLng(a,o),s=z.a.DomUtil.create("canvas","leaflet-tile");s.width=e.tilesize,s.height=e.tilesize;var c=s.getContext("2d");c.fillStyle="white",c.lineWidth=1,c.font="14px Arial",c.strokeStyle="black";var l=r/e.regionsize;if(l>=1){var u=0;while(u<e.tilesize)c.beginPath(),c.moveTo(u,0),c.lineTo(u,e.tilesize),c.stroke(),c.beginPath(),c.moveTo(0,u),c.lineTo(e.tilesize,u),c.stroke(),u+=e.tilesize/l;var p=t.CoordToRegion(i),m=t.FormatRegionFileName(p);c.lineWidth=4,c.strokeText(m,4,e.tilesize-5),c.fillText(m,4,e.tilesize-5)}else if(a%e.regionsize==0&&(c.beginPath(),c.moveTo(0,0),c.lineTo(0,e.tilesize),c.stroke()),o%e.regionsize==0&&(c.beginPath(),c.moveTo(0,e.tilesize),c.lineTo(e.tilesize,e.tilesize),c.stroke()),a%e.regionsize==0&&o%e.regionsize==0){var d=t.CoordToRegion(i),h=t.FormatRegionFileName(d);c.lineWidth=4,c.strokeText(h,4,e.tilesize-5),c.fillText(h,4,e.tilesize-5)}return s},n},createCoordinateControl:function(){z.a.Control.Coordinates=z.a.Control.extend({options:{position:"bottomleft"},onAdd:function(e){var t="control-coordinates",n=z.a.DomUtil.create("div",t+" webmap-control");return n.innerHTML="Mouse pos: - N / - E<br/>Last click: - N / - E",z.a.DomEvent.on(n,"mousemove",z.a.DomEvent.stopPropagation),this._map=e,this._div=n,e.on("mousemove",this._onMouseMove,this),e.on("mouseout",this._onMouseOut,this),e.on("click",this._onClick,this),n},_onMouseMove:function(e){this.lastPos=e.latlng,this._updateText()},_onMouseOut:function(){this.lastPos=!1,this._updateText()},_onClick:function(e){this.lastClick=e.latlng,this._updateText()},_updateText:function(){this._div.innerHTML="Mouse pos: "+this._formatCoord(this.lastPos)+"<br/>Last click: "+this._formatCoord(this.lastClick)},_formatCoord:function(e){return 0==e?"- N / - E":Math.abs(e.lng).toFixed(0)+(e.lng>=0?" N":" S")+" / "+Math.abs(e.lat).toFixed(0)+(e.lat>=0?" E":" W")},lastPos:!1,lastClick:!1}),new z.a.Control.Coordinates({position:"topright"}).addTo(this.map)}}},X=G,Q=(n("9a8d"),Object(h["a"])(X,Y,D,!1,null,null,null)),J=Q.exports,K=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"session"},[e.userStatus.loggedin?n("div",[e._v(" "+e._s(this.userStatus.username)+" - Permission level: "+e._s(this.userStatus.permissionlevel)+" "),n("br"),e._m(0)]):n("a",{attrs:{href:"/session/login"}},[n("img",{attrs:{src:"img/steamlogin.png"}})])])},ee=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"/session/logout"}},[n("button",{staticClass:"btn btn-danger",attrs:{type:"button"}},[e._v("Logout")])])}],te={name:"SessionHandler",data:function(){return{userStatus:{loggedin:!1,username:null,permissionlevel:2e3,permissions:[]}}},mounted:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getUserStatus();case 2:this.userStatus=e.sent;case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{getUserStatus:function(){return fetch("/userstatus").then((function(e){return e.json()})).then((function(e){return e}))}}},ne=te,re=(n("67b5"),Object(h["a"])(ne,K,ee,!1,null,"3fcba173",null)),ae=re.exports,oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nav",[n("sidebar-menu",{attrs:{menu:e.menu},on:{"item-click":e.onItemClick}},[n("span",{attrs:{slot:"toggle-icon"},slot:"toggle-icon"},[n("font-awesome-icon",{attrs:{icon:"arrows-alt-h",size:"xl"}})],1),n("span",{attrs:{slot:"dropdown-icon"},slot:"dropdown-icon"},[n("font-awesome-icon",{attrs:{icon:"angle-right",size:"xs"}})],1)]),n("server-settings"),n("claims"),n("commands-modal")],1)},ie=[],se={mounted:function(){var e=Object(T["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i,s,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.menu.filter((function(e){return"User"==e.title}))[0],n=this.menu.filter((function(e){return"Commands"==e.title}))[0],pe.$on("set-commands",(function(e){n.badge.text=e})),e.next=5,this.getUserStatus();case 5:if(this.userStatus=e.sent,!this.userStatus.loggedin){e.next=30;break}for(t.child.push({title:this.userStatus.username}),t.child.push({href:"/session/logout",title:"Log out"}),r=!0,a=!1,o=void 0,e.prev=12,i=this.userStatus.permissions[Symbol.iterator]();!(r=(s=i.next()).done);r=!0)c=s.value,"cpmcc.Null"!==c.module&&t.child.push({title:"".concat(c.module.replace("cpmcc.","")," - ").concat(c.allowed?"Yes":"No")});e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](12),a=!0,o=e.t0;case 20:e.prev=20,e.prev=21,r||null==i.return||i.return();case 23:if(e.prev=23,!a){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(20);case 28:e.next=35;break;case 30:this.menu=[],this.menu.push({title:"User",icon:{element:"font-awesome-icon",attributes:{icon:"user"}},child:[]}),l=this.menu.filter((function(e){return"User"==e.title}))[0],l.title="Not logged in",l.child.push({title:"Log in via Steam",href:"/session/login"});case 35:case"end":return e.stop()}}),e,this,[[12,16,20,28],[21,,23,27]])})));function t(){return e.apply(this,arguments)}return t}(),methods:{onItemClick:function(e,t){if(t.attributes){var n=t.attributes["v-b-modal"];if(n)return this.$bvModal.show(n)}},getUserStatus:function(){return fetch("/userstatus").then((function(e){return e.json()})).then((function(e){return e}))}},data:function(){return{commands:0,userStatus:{loggedin:!1,username:null,permissionlevel:2e3,permissions:[]},menu:[{header:!0,title:"CPM Web UI",hiddenOnCollapse:!0},{title:"Claims",icon:{element:"font-awesome-icon",attributes:{icon:"border-style"}},attributes:{"v-b-modal":"claims"}},{title:"Commands",icon:{element:"font-awesome-icon",attributes:{icon:"terminal"}},attributes:{"v-b-modal":"commands"},badge:{text:0,class:"vsm--badge_default"}},{title:"User",icon:{element:"font-awesome-icon",attributes:{icon:"user"}},child:[]},{title:"Help",icon:{element:"font-awesome-icon",attributes:{icon:"question-circle"}},child:[{href:"https://docs.csmm.app/en/CPM/",title:"Documentation",attributes:{target:"_blank"}},{href:"https://catalysm.net/discord",title:"Discord",attributes:{target:"_blank"}}]}]}}},ce=se,le=Object(h["a"])(ce,oe,ie,!1,null,null,null),ue=le.exports;n.d(t,"eventBus",(function(){return pe})),n("6cc5"),window.claimTypes=["hostilefree","notify","command","leveled","reversed","normal","timed","portal","openhours","playerlevel","lcbfree","antiblock","reset","problock","landclaim"],window.allocsMap={host:location.hostname,port:parseInt(location.port)-1,protocol:location.protocol},r["c"].add(a["e"]),r["c"].add(a["h"]),r["c"].add(a["b"]),r["c"].add(a["i"]),r["c"].add(a["d"]),r["c"].add(a["c"]),r["c"].add(a["g"]),r["c"].add(a["f"]),r["c"].add(a["a"]),s["default"].component("font-awesome-icon",o["a"]),s["default"].component("sidebar",ue),s["default"].component("sdtd-map",J),s["default"].component("claims",j),s["default"].component("claim-creator",w),s["default"].component("commands-modal",B),s["default"].component("session-handler",ae),s["default"].use(i["a"]),s["default"].use(l.a),s["default"].config.productionTip=!1;var pe=new s["default"];new s["default"]({render:function(e){return e(v)}}).$mount("#app")},"5fd8":function(e,t,n){},"67b5":function(e,t,n){"use strict";var r=n("dd17"),a=n.n(r);a.a},"85ec":function(e,t,n){},9492:function(e,t,n){},"9a8d":function(e,t,n){"use strict";var r=n("9492"),a=n.n(r);a.a},b167:function(e,t,n){"use strict";var r=n("5fd8"),a=n.n(r);a.a},dd17:function(e,t,n){}});
//# sourceMappingURL=app.a61c7143.js.map